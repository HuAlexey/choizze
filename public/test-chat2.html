<!DOCTYPE html>
<html>
<head>
  <title>CHOIZZE Chat Test (testuser)</title>
  <script src="/socket.io/socket.io.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-4">
    <h1 class="mb-3">CHOIZZE Chat Test (testuser)</h1>
    <div class="mb-3">
      <label for="receiverId" class="form-label">Receiver ID</label>
      <input id="receiverId" class="form-control" placeholder="Введите ID получателя" value="68a08cc2c44a0d3f9eecc1d1">
    </div>
    <div class="mb-3">
      <label for="message" class="form-label">Сообщение</label>
      <input id="message" class="form-control" placeholder="Введите сообщение">
    </div>
    <button onclick="sendMessage()" class="btn btn-primary">Отправить</button>
    <ul id="messages" class="list-group mt-3"></ul>
  </div>
  <script>
    const socket = io('http://localhost:3000');
    const userId = '689edd0b85a1a132e18c1974'; // testuser
    const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2OGEwOGNjMmM0NGEwZDNmOWVlY2MxZDEiLCJpYXQiOjE3NTUzNTIyNTgsImV4cCI6MTc1NTM1NTg1OH0.Qq0ruz7hUiU0NWDBV0e1FpJgGRQKbTGKIxqtEK1fe_0';
    socket.on('connect', () => {
      console.log('Подключено к серверу');
      socket.emit('join', { userId });
    });
    socket.on('message', (msg) => {
      const li = document.createElement('li');
      li.className = 'list-group-item';
      li.textContent = `${msg.sender_id}: ${msg.message_text}`;
      document.getElementById('messages').appendChild(li);
    });
    function sendMessage() {
      const receiverId = document.getElementById('receiverId').value.trim();
      const content = document.getElementById('message').value.trim();
      if (!receiverId || !content) {
        alert('Введите ID получателя и сообщение');
        return;
      }
      socket.emit('message', { senderId: userId, receiverId, content });
      document.getElementById('message').value = '';
    }
  </script>
</body>
</html>